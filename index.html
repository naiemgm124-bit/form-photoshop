<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Form Photoshop</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family: serif;
  background:#f2f2f2;
}
.container{
  max-width:420px;
  margin:20px auto;
  background:#fff;
  padding:15px;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,.15);
}
h2{text-align:center;}
input,button{
  width:100%;
  margin:6px 0;
  padding:8px;
  font-size:16px;
}
canvas{
  width:100%;
  border:1px solid #ccc;
  margin-top:10px;
}
.buttons{
  display:flex;
  gap:10px;
}
</style>
</head>
<body>

<div class="container">
<h2>Form Photoshop</h2>

<input type="file" id="file" accept="image/*">

<input type="number" id="w" placeholder="Width (px)" value="300">
<input type="number" id="h" placeholder="Height (px)" value="300">
<input type="number" id="kb" placeholder="Max KB" value="100">

<canvas id="canvas"></canvas>

<div class="buttons">
<button onclick="apply()">Apply & Preview</button>
<button onclick="download()">Download</button>
</div>
</div>

<script>
let img=new Image(), canvas=document.getElementById("canvas"), ctx=canvas.getContext("2d");

document.getElementById("file").onchange=e=>{
  let r=new FileReader();
  r.onload=()=>{ img.src=r.result; };
  r.readAsDataURL(e.target.files[0]);
};

function apply(){
  if(!img.src){ alert("Select image"); return; }

  let w=+wInput.value||300;
  let h=+hInput.value||300;

  canvas.width=w;
  canvas.height=h;

  let ratio=Math.max(w/img.width,h/img.height);
  let nw=img.width*ratio, nh=img.height*ratio;
  let x=(w-nw)/2, y=(h-nh)/2;

  ctx.fillStyle="#fff";
  ctx.fillRect(0,0,w,h);
  ctx.drawImage(img,x,y,nw,nh);
}

function download(){
  let maxKB=+kbInput.value||100;
  let q=0.95, data;
  do{
    data=canvas.toDataURL("image/jpeg",q);
    q-=0.03;
  }while(data.length/1024>maxKB && q>0.5);

  let a=document.createElement("a");
  a.href=data;
  a.download="photo.jpg";
  a.click();
}

const wInput=document.getElementById("w");
const hInput=document.getElementById("h");
const kbInput=document.getElementById("kb");
</script>

</body>
</html>

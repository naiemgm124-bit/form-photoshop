<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tanvir Photo Resizer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#0b1f1a,#020a08 60%);
  font-family:"Courier New", monospace;
  color:#7CFFB2;
  display:flex;
  justify-content:center;
  align-items:center;
}
.panel{
  width:100%;
  max-width:420px;
  background:rgba(5,20,15,.9);
  border-radius:18px;
  padding:22px;
  border:1px solid rgba(0,255,150,.3);
  box-shadow:0 0 35px rgba(0,255,150,.25);
}
h1{text-align:center;font-size:20px;margin:10px 0 20px}
label{display:block;margin-top:14px;font-size:13px}

input,button{
  width:100%;
  padding:12px;
  margin-top:6px;
  background:#061612;
  border:1px solid rgba(0,255,150,.35);
  border-radius:12px;
  color:#9fffd6;
  font-family:inherit;
}

/* ===== QUALITY ===== */
.qualityTop{display:flex;justify-content:space-between}
.qualityValue{color:#39ff9f;font-weight:bold}

input[type=range]{
  -webkit-appearance:none;
  width:100%;
  height:6px;
  border-radius:6px;
  background:linear-gradient(
    to right,
    #00ff99 0%,
    #00ff99 var(--val,80%),
    #1e3a32 var(--val,80%),
    #1e3a32 100%
  );
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:20px;height:20px;border-radius:50%;
  background:#00ff99;
  box-shadow:0 0 12px rgba(0,255,153,.9);
}

.presetRow{display:flex;gap:8px;margin-top:8px}
.presetRow button{flex:1;background:transparent}
.presetRow button.active{
  background:#00ff99;
  color:#003b23;
  box-shadow:0 0 12px rgba(0,255,153,.8);
}

canvas{
  width:100%;
  margin-top:16px;
  background:#02100c;
  border:1px dashed rgba(0,255,150,.35);
  border-radius:12px;
  touch-action:none;
}

.row{display:flex;gap:10px;margin-top:10px}
.row button{flex:1;background:transparent}

button.main{
  background:linear-gradient(180deg,#0cff9a,#00b870);
  color:#002b18;
  box-shadow:0 0 18px rgba(0,255,150,.6);
}
</style>
</head>

<body>
<div class="panel">
  <h1>TANVIR PHOTO RESIZER</h1>

  <input type="file" id="file" accept="image/*">

  <label>Width (px)</label>
  <input type="number" id="w" value="300">

  <label>Height (px)</label>
  <input type="number" id="h" value="300">

  <!-- QUALITY -->
  <div class="qualityTop">
    <span>Quality</span>
    <span class="qualityValue"><span id="qVal">80</span>%</span>
  </div>
  <input type="range" id="quality" min="10" max="100" value="80">
  <div class="presetRow">
    <button onclick="setQuality(60)">LOW</button>
    <button class="active" onclick="setQuality(80)">MEDIUM</button>
    <button onclick="setQuality(95)">HIGH</button>
  </div>

  <canvas id="canvas"></canvas>

  <div class="row">
    <button onclick="removeBg()">REMOVE BG</button>
    <button onclick="reset()">RESET</button>
  </div>

  <button class="main" onclick="apply()">APPLY & PREVIEW</button>
  <button onclick="download()">DOWNLOAD</button>
</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const img=new Image();

let originalFile=null;
let crop=null, drag=false, sx=0, sy=0;

const quality=document.getElementById("quality");
const qVal=document.getElementById("qVal");
const presets=document.querySelectorAll(".presetRow button");

/* QUALITY */
quality.oninput=()=>{
  qVal.textContent=quality.value;
  quality.style.setProperty("--val",quality.value+"%");
  apply(false);
};
quality.dispatchEvent(new Event("input"));

function setQuality(v){
  quality.value=v;
  presets.forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  quality.dispatchEvent(new Event("input"));
}

/* IMAGE LOAD */
file.onchange=e=>{
  originalFile=e.target.files[0];
  const r=new FileReader();
  r.onload=()=>img.src=r.result;
  r.readAsDataURL(originalFile);
};
img.onload=()=>reset();

/* RESET */
function reset(){
  crop=null;
  apply(false);
}

/* CROP */
function getPos(e){
  const r=canvas.getBoundingClientRect();
  const t=e.touches?e.touches[0]:e;
  return{x:t.clientX-r.left,y:t.clientY-r.top};
}

canvas.onmousedown=canvas.ontouchstart=e=>{
  const p=getPos(e);
  sx=p.x; sy=p.y;
  crop={x:sx,y:sy,w:0,h:0};
  drag=true;
};

canvas.onmousemove=canvas.ontouchmove=e=>{
  if(!drag) return;
  const p=getPos(e);
  crop={
    x:Math.min(sx,p.x),
    y:Math.min(sy,p.y),
    w:Math.abs(p.x-sx),
    h:Math.abs(p.y-sy)
  };
  redraw();
};

canvas.onmouseup=canvas.ontouchend=()=>drag=false;

function redraw(){
  apply(false);
  if(crop){
    ctx.setLineDash([6,4]);
    ctx.strokeStyle="#00ff99";
    ctx.lineWidth=2;
    ctx.strokeRect(crop.x,crop.y,crop.w,crop.h);
    ctx.setLineDash([]);
  }
}

/* APPLY */
function apply(useCrop=true){
  if(!img.src) return;
  const W=+w.value, H=+h.value;
  canvas.width=W; canvas.height=H;

  ctx.imageSmoothingEnabled=true;
  ctx.imageSmoothingQuality="high";

  ctx.fillStyle="#fff";
  ctx.fillRect(0,0,W,H);

  let ix=0,iy=0,iw=img.width,ih=img.height;
  if(crop && useCrop){
    const rx=img.width/W, ry=img.height/H;
    ix=crop.x*rx; iy=crop.y*ry;
    iw=crop.w*rx; ih=crop.h*ry;
  }
  ctx.drawImage(img,ix,iy,iw,ih,0,0,W,H);
}

/* REMOVE BG â†’ PHOTOROOM */
function removeBg(){
  window.open(
    "https://www.photoroom.com/tools/background-remover",
    "_blank"
  );
}

/* DOWNLOAD */
function download(){
  const a=document.createElement("a");
  a.href=canvas.toDataURL("image/jpeg",quality.value/100);
  a.download="photo.jpg";
  a.click();
}
</script>
</body>
</html>
